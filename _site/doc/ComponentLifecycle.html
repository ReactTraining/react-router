<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>React Router : Component Lifecycle</title>
        <meta name="description" content="A complete routing library for React.">

        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/css/syntax.css">
        <link rel="stylesheet" href="/css/main.css">
    </head>
    <body>

        <div class="container">
            <div class="row">
                <div id="header" class="col-sm-12">
                    <h4><a class="brand" href="/">React Router</a>
    <small>A complete routing library for React.</small>
</h4>

                </div>
            </div>

            <div class="row">
                
                
                    <div id="navigation" class="col-sm-2">
                        <ul class="nav nav-list">
    <li><a href="/">Home</a></li>
    
        
        

        
            
                <li class="nav-header">Documentation</li>
            
            <li data-order="13"><a href="/doc/v2.0.0.html">v2.0.0 Upgrade Guide</a></li>
        
            
            <li data-order="12"><a href="/doc/v1.0.0.html">v1.0.0 Upgrade Guide</a></li>
        
            
            <li data-order="14"><a href="/doc/Troubleshooting.html">Troubleshooting</a></li>
        
            
            <li data-order="7"><a href="/doc/ServerRendering.html">Server Rendering</a></li>
        
            
            <li data-order="9"><a href="/doc/NavigationOutsideOfComponents.html">Navigating Outside of Components</a></li>
        
            
            <li data-order="10"><a href="/doc/MinimizingBundleSize.html">Minimizing Bundle Size</a></li>
        
            
            <li data-order="4"><a href="/doc/IndexRoutes.html">Index Routes and Links</a></li>
        
            
            <li data-order="3"><a href="/doc/Histories.html">Histories</a></li>
        
            
            <li data-order="16"><a href="/doc/Glossary.html">Glossary</a></li>
        
            
            <li data-order="5"><a href="/doc/DynamicRouting.html">Dynamic Routing</a></li>
        
            
            <li data-order="6"><a href="/doc/ConfirmingNavigation.html">Confirming Navigation</a></li>
        
            
            <li data-order="8"><a href="/doc/ComponentLifecycle.html">Component Lifecycle</a></li>
        
            
            <li data-order="11"><a href="/doc/CHANGES.html">Change Log</a></li>
        
            
            <li data-order="15"><a href="/doc/API.html">API Reference</a></li>
        
            
            <li data-order="2"><a href="/doc/RouteMatching.html">Route Matching</a></li>
        
            
            <li data-order="1"><a href="/doc/RouteConfiguration.html">Route Configuration</a></li>
        
    
        
        

        
    
        
        

        
    
        
        

        
    
        
        

        
    
<!-- List additional links. It is recommended to add a divider
    e.g. <li class="divider"></li> first to break up the content. -->
</ul>

                    </div>

                    <div id="content" class="col-sm-10">
                        <div class="page-header">
    <h2>Component Lifecycle
        
    </h2>
</div>

<p>It&#39;s important to understand which lifecycle hooks are going to be called
on your route components to implement lots of different functionality in
your app. The most common thing is fetching data.</p>

<p>There is no difference in the lifecycle of a component in the router as
just React itself. Let&#39;s peel away the idea of routes, and just think
about the components being rendered at different URLs.</p>

<p>Consider this route config:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;/&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">App</span><span class="p">}</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">IndexRoute</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Home</span><span class="p">}</span><span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;invoices/:invoiceId&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Invoice</span><span class="p">}</span><span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="nx">Route</span> <span class="nx">path</span><span class="o">=</span><span class="s2">&quot;accounts/:accountId&quot;</span> <span class="nx">component</span><span class="o">=</span><span class="p">{</span><span class="nx">Account</span><span class="p">}</span><span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="err">/Route&gt;</span>
</code></pre></div>
<h3 id="lifecycle-hooks-when-routing">Lifecycle hooks when routing</h3>

<ol>
<li><p>Lets say the user enters the app at <code>/</code>.</p>

<table><thead>
<tr>
<th>Component</th>
<th>Lifecycle Hooks called</th>
</tr>
</thead><tbody>
<tr>
<td>App</td>
<td><code>componentDidMount</code></td>
</tr>
<tr>
<td>Home</td>
<td><code>componentDidMount</code></td>
</tr>
<tr>
<td>Invoice</td>
<td>N/A</td>
</tr>
<tr>
<td>Account</td>
<td>N/A</td>
</tr>
</tbody></table></li>
<li><p>Now they navigate from <code>/</code> to <code>/invoices/123</code></p>

<table><thead>
<tr>
<th>Component</th>
<th>Lifecycle Hooks called</th>
</tr>
</thead><tbody>
<tr>
<td>App</td>
<td><code>componentWillReceiveProps</code>, <code>componentDidUpdate</code></td>
</tr>
<tr>
<td>Home</td>
<td><code>componentWillUnmount</code></td>
</tr>
<tr>
<td>Invoice</td>
<td><code>componentDidMount</code></td>
</tr>
<tr>
<td>Account</td>
<td>N/A</td>
</tr>
</tbody></table></li>
</ol>
<div class="highlight"><pre><code class="language-text" data-lang="text">- `App` gets `componentWillReceiveProps` and `componentDidUpdate` because it
stayed rendered but just received new props from the router (like:
`children`, `params`, `location`, etc.)
- `Home` is no longer rendered, so it gets unmounted.
- `Invoice` is mounted for the first time.
</code></pre></div>
<ol>
<li><p>Now they navigate from <code>/invoices/123</code> to <code>/invoices/789</code></p>

<table><thead>
<tr>
<th>Component</th>
<th>Lifecycle Hooks called</th>
</tr>
</thead><tbody>
<tr>
<td>App</td>
<td><code>componentWillReceiveProps</code>, <code>componentDidUpdate</code></td>
</tr>
<tr>
<td>Home</td>
<td>N/A</td>
</tr>
<tr>
<td>Invoice</td>
<td><code>componentWillReceiveProps</code>, <code>componentDidUpdate</code></td>
</tr>
<tr>
<td>Account</td>
<td>N/A</td>
</tr>
</tbody></table>

<p>All the components that were mounted before, are still mounted, they
just receive new props from the router.</p></li>
<li><p>Now they navigate from <code>/invoices/789</code> to <code>/accounts/123</code></p>

<table><thead>
<tr>
<th>Component</th>
<th>Lifecycle Hooks called</th>
</tr>
</thead><tbody>
<tr>
<td>App</td>
<td><code>componentWillReceiveProps</code>, <code>componentDidUpdate</code></td>
</tr>
<tr>
<td>Home</td>
<td>N/A</td>
</tr>
<tr>
<td>Invoice</td>
<td><code>componentWillUnmount</code></td>
</tr>
<tr>
<td>Account</td>
<td><code>componentDidMount</code></td>
</tr>
</tbody></table></li>
</ol>

<h3 id="fetching-data">Fetching Data</h3>

<p>While there are other ways to fetch data with the router, the simplest
way is to simply use the lifecycle hooks of your components and keep
that data in state. Now that we understand the lifecycle of components
when changing routes, we can implement simple data fetching inside of
<code>Invoice</code>.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">let</span> <span class="nx">Invoice</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>

  <span class="nx">getInitialState</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">invoice</span><span class="o">:</span> <span class="kc">null</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">componentDidMount</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// fetch data initially in scenario 2 from above</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">fetchInvoice</span><span class="p">()</span>
  <span class="p">},</span>

  <span class="nx">componentDidUpdate</span> <span class="p">(</span><span class="nx">prevProps</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// respond to parameter change in scenario 3</span>
    <span class="kd">let</span> <span class="nx">oldId</span> <span class="o">=</span> <span class="nx">prevProps</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">invoiceId</span>
    <span class="kd">let</span> <span class="nx">newId</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">invoiceId</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">newId</span> <span class="o">!==</span> <span class="nx">oldId</span><span class="p">)</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">fetchInvoice</span><span class="p">()</span>
  <span class="p">},</span>

  <span class="nx">componentWillUnmount</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// allows us to ignore an inflight request in scenario 4</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">ignoreLastFetch</span> <span class="o">=</span> <span class="kc">true</span>
  <span class="p">},</span>

  <span class="nx">fetchInvoice</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="err">`</span><span class="o">/</span><span class="nx">api</span><span class="o">/</span><span class="nx">invoices</span><span class="o">/</span><span class="nx">$</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">invoiceId</span><span class="p">}</span><span class="err">`</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">request</span> <span class="o">=</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">ignoreLastFetch</span><span class="p">)</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">invoice</span><span class="o">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">invoice</span> <span class="p">})</span>
    <span class="p">})</span>
  <span class="p">},</span>

  <span class="nx">render</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">InvoiceView</span> <span class="nx">invoice</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">invoice</span><span class="p">}</span><span class="o">/&gt;</span>
  <span class="p">}</span>

<span class="p">})</span>
</code></pre></div>

                    </div>
                
            </div>

            

            <div class="row">
                <div id="footer" class="col-sm-12">
                    Documentation for <a href="https://github.com/reactjs/react-router">React Router</a>

                </div>
            </div>
        </div>

        <script>
            function orderNav() {
                var list,
                    section,
                    header,
                    sections = [],
                    lists = {},
                    headers = {};

                var navUl = document.querySelectorAll('#navigation ul')[0],
                    navLis = document.querySelectorAll('#navigation ul li');

                if (!navUl) return;

                for (var i = 0; i < navLis.length; i++) {
                    var order, li = navLis[i];

                    if (li.classList.contains('nav-header')) {
                        section = li.textContent || li.innerText;
                        sections.push(section);
                        headers[section] = li;
                        continue;
                    }

                    if (!lists[section]) {
                        lists[section] = [];
                    }

                    order = parseFloat(li.getAttribute('data-order'))
                    lists[section].push([order, li]);
                }

                for (var i = 0; i < sections.length; i++) {
                    section = sections[i];
                    list = lists[section].sort(function(a, b) {
                        return a[0] - b[0];
                    });

                    if (header = headers[section]) {
                        navUl.appendChild(header);
                    }
                    for (var j = 0; j < list.length; j++) {
                        navUl.appendChild(list[j][1]);
                    }
                }
            }

            if (document.querySelectorAll) orderNav();
        </script>
        
    </body>
</html>
